<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Painel Administrativo{% endblock %} - WDespachante</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@4.2.0/fonts/remixicon.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    {% block head_extra %}{% endblock %}
</head>
<body>
    <div class="admin-container">
        <aside id="sidebar" class="fixed top-0 left-0 z-40 w-64 h-screen pt-20 transition-transform -translate-x-full bg-white border-r border-gray-200 sm:translate-x-0">
            <div class="h-full px-3 pb-4 overflow-y-auto bg-white">
                <!-- Menu Principal -->
                <ul class="space-y-2">
                    <li>
                        <a href="{{ url_for('admin.index') }}" class="flex items-center p-2 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">
                            <i class="ri-dashboard-line text-xl text-gray-500"></i>
                            <span class="ml-3">Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <button type="button" class="flex items-center w-full p-2 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100" aria-controls="dropdown-content" data-collapse-toggle="dropdown-content">
                            <i class="ri-newspaper-line text-xl text-gray-500"></i>
                            <span class="flex-1 ml-3 text-left whitespace-nowrap">Conteúdo</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </button>
                        <ul id="dropdown-content" class="hidden py-2 space-y-2">
                            <li><a href="{{ url_for('newsadminview.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Notícias</a></li>
                            <li><a href="{{ url_for('category.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Categorias</a></li>
                            <li><a href="{{ url_for('tag.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Tags</a></li>
                            <li><a href="{{ url_for('comment.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Comentários</a></li>
                        </ul>
                    </li>
                     <li>
                        <button type="button" class="flex items-center w-full p-2 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100" aria-controls="dropdown-site" data-collapse-toggle="dropdown-site">
                            <i class="ri-global-line text-xl text-gray-500"></i>
                            <span class="flex-1 ml-3 text-left whitespace-nowrap">Site</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </button>
                        <ul id="dropdown-site" class="hidden py-2 space-y-2">
                            <li><a href="{{ url_for('serviceadminview.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Serviços</a></li>
                            <li><a href="{{ url_for('testimonialadminview.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Depoimentos</a></li>
                            <li><a href="{{ url_for('faqadminview.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">FAQs</a></li>
                            <li><a href="{{ url_for('linkutiladminview.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Links Úteis</a></li>
                            <li><a href="{{ url_for('detranadminview.index_view') }}" class="flex items-center w-full p-2 pl-11 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">Detrans</a></li>
                        </ul>
                    </li>
                    {% if current_user.is_admin %}
                    <li>
                        <a href="{{ url_for('useradminview.index_view') }}" class="flex items-center p-2 text-base font-normal text-gray-900 rounded-lg hover:bg-gray-100">
                            <i class="ri-user-settings-line text-xl text-gray-500"></i>
                            <span class="ml-3">Usuários</span>
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </aside>
        <main class="admin-main-content">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages-container">
                        {% for category, message in messages %}
                            <div class="alert {% if category == 'error' %}alert-danger{% else %}alert-success{% endif %}">
                                <i class="fas {% if category == 'error' %}fa-exclamation-circle{% else %}fa-check-circle{% endif %}"></i>
                                <span>{{ message }}</span>
                                <button type="button" class="close-alert">&times;</button>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            {% block content %}{% endblock %}
        </main>
    </div>

    {% block scripts %}{% endblock %}
    <script>
        // Lógica global para fechar alertas
        document.addEventListener('DOMContentLoaded', () => {
            const closeButtons = document.querySelectorAll('.close-alert');
            closeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const alert = this.parentElement;
                    alert.style.opacity = '0';
                    setTimeout(() => {
                        alert.style.display = 'none';
                    }, 300);
                });
            });

            // Lógica do Seletor de Tema
            const themeSwitcher = document.getElementById('theme-switcher');
            const body = document.body;

            const setTheme = (theme) => {
                if (theme === 'light') {
                    body.classList.add('theme-light');
                } else {
                    body.classList.remove('theme-light');
                }
                localStorage.setItem('adminTheme', theme);
            };

            themeSwitcher.addEventListener('click', () => {
                const isLight = body.classList.contains('theme-light');
                setTheme(isLight ? 'dark' : 'light');
            });

            // Aplicar tema salvo ao carregar a página
            const savedTheme = localStorage.getItem('adminTheme') || 'dark'; // Padrão para escuro
            setTheme(savedTheme);
        });
    </script>
</body>
</html> 